### [CVE-2020-36791](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-36791)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=2c66ff8d08f81bcf8e8cb22e31e39c051b15336a%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=4.14.171%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=4.19.103%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=4.4.214%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=4.9.214%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=478c4b2ffd44e5186c7e22ae7c38a86a5b9cfde5%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=5.4.19%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=5.5.3%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=599be01ee567b61f4471ee8078870847d0a11e8e%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=6cb448ee493c8a514c9afa0c346f3f5b3227de85%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=73c29d2f6f8ae731b1e09051b69ed3ba2319482b%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=b974ac51f5834a729de252fc5c1c9de9efd79b45%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=dd8142a6fa5270783d415292ec8169f4ea2a5468%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:net_sched: keep alloc_hash updated after hash allocationIn commit 599be01ee567 ("net_sched: fix an OOB access in cls_tcindex")I moved cp->hash calculation before the firsttcindex_alloc_perfect_hash(), but cp->alloc_hash is left untouched.This difference could lead to another out of bound access.cp->alloc_hash should always be the size allocated, we shouldupdate it after this tcindex_alloc_perfect_hash().

### POC

#### Reference
- https://blog.cdthoughts.ch/2021/03/16/syzbot-bug.html

#### Github
No PoCs found on GitHub currently.

