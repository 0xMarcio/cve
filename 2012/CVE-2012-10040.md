### [CVE-2012-10040](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-10040)
![](https://img.shields.io/static/v1?label=Product&message=Openfiler&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=2.x%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-78%20Improper%20Neutralization%20of%20Special%20Elements%20used%20in%20an%20OS%20Command%20('OS%20Command%20Injection')&color=brightgreen)

### Description

Openfiler v2.x contains a command injection vulnerability in the system.html page. The device parameter is used to instantiate a NetworkCard object, whose constructor in network.inc calls exec() with unsanitized input. An authenticated attacker can exploit this to execute arbitrary commands as the openfiler user. Due to misconfigured sudoers, the openfiler user can escalate privileges to root via sudo /bin/bash without a password.

### POC

#### Reference
- http://web.archive.org/web/20210922060411/https://itsecuritysolutions.org/2012-09-06-Openfiler-v2.x-multiple-vulnerabilities/
- https://www.exploit-db.com/exploits/21191

#### Github
- https://github.com/fkie-cad/nvd-json-data-feeds

