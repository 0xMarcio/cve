### [CVE-2019-5597](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5597)
![](https://img.shields.io/static/v1?label=Product&message=FreeBSD&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=FreeBSD%2011.2%20before%2011.2-RELEASE-p10%20and%2012.0%20before%2012.0-RELEASE-p4%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=Improper%20Check%20for%20Unusual%20or%20Exceptional%20Conditions&color=brightgreen)

### Description

In FreeBSD 11.3-PRERELEASE and 12.0-STABLE before r347591, 11.2-RELEASE before 11.2-RELEASE-p10, and 12.0-RELEASE before 12.0-RELEASE-p4, a bug in the pf IPv6 fragment reassembly logic incorrectly uses the last extension header offset from the last received packet instead of the first packet allowing maliciously crafted IPv6 packets to cause a crash or potentially bypass the packet filter.

### POC

#### Reference
- http://packetstormsecurity.com/files/152933/FreeBSD-Security-Advisory-FreeBSD-SA-19-05.pf.html
- https://www.oracle.com/technetwork/security-advisory/cpujul2019-5072835.html

#### Github
- https://github.com/ARPSyndicate/cvemon
- https://github.com/secdev/awesome-scapy

