### [CVE-2019-12400](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-12400)
![](https://img.shields.io/static/v1?label=Product&message=Apache%20Santuario%20-%20XML%20Security%20for%20Java&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=All%202.0.x%20releases%20from%202.0.3%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=all%202.1.x%20releases%20before%202.1.4.%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=Process%20Control&color=brightgreen)

### Description

In version 2.0.3 Apache Santuario XML Security for Java, a caching mechanism was introduced to speed up creating new XML documents using a static pool of DocumentBuilders. However, if some untrusted code can register a malicious implementation with the thread context class loader first, then this implementation might be cached and re-used by Apache Santuario - XML Security for Java, leading to potential security flaws when validating signed documents, etc. The vulnerability affects Apache Santuario - XML Security for Java 2.0.x releases from 2.0.3 and all 2.1.x releases before 2.1.4.

### POC

#### Reference
- https://www.oracle.com/security-alerts/cpuoct2021.html

#### Github
- https://github.com/ARPSyndicate/cvemon
- https://github.com/RosalindDeckow/java-saml
- https://github.com/SAML-Toolkits/java-saml
- https://github.com/VallieRunte/javascript-web
- https://github.com/ik21191/java-saml
- https://github.com/onelogin/java-saml
- https://github.com/umeshnagori/java-saml-os

