### [CVE-2024-52292](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-52292)
![](https://img.shields.io/static/v1?label=Product&message=cms&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%203.5.13%2C%20%3C%204.12.8%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%205.0.0-alpha.1%2C%20%3C%205.4.9%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-22%3A%20Improper%20Limitation%20of%20a%20Pathname%20to%20a%20Restricted%20Directory%20('Path%20Traversal')&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-552%3A%20Files%20or%20Directories%20Accessible%20to%20External%20Parties&color=brightgreen)

### Description

Craft is a content management system (CMS). The dataUrl function can be exploited if an attacker has write permissions on system notification templates. This function accepts an absolute file path, reads the file's content, and converts it into a Base64-encoded string. By embedding this function within a system notification template, the attacker can exfiltrate the Base64-encoded file content through a triggered system email notification. Once the email is received, the Base64 payload can be decoded, allowing the attacker to read arbitrary files on the server. This is fixed in 5.4.9 and 4.12.8.

### POC

#### Reference
- https://github.com/craftcms/cms/security/advisories/GHSA-cw6g-qmjq-6w2w

#### Github
No PoCs found on GitHub currently.

