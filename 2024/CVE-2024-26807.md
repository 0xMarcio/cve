### [CVE-2024-26807](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26807)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=1368dbc0a432acf9fc0dcb23bfe52d32ca4c09ab%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=18cb554e9da81bc4eca653c17a0d65e8b5835c09%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=2087e85bb66ee3652dafe732bb9b9b896229eafc%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=6.4%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=6716203844bc8489af5e5564f0fa31e0c094a7ff%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=79acf7fb856eade9c3d0cf00fd34a04bf5c43a1c%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=b24f1ecc8fe2ceefc14af02edb1744c246d87bf7%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=d453f25faf681799d636fe9d6899ad91c45aa11e%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=e3f9fc9a4f1499cc9e1bad4482d377494e367b3d%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:Both cadence-quadspi ->runtime_suspend() and ->runtime_resume()implementations start with:	struct cqspi_st *cqspi = dev_get_drvdata(dev);	struct spi_controller *host = dev_get_drvdata(dev);This obviously cannot be correct, unless "struct cqspi_st" is thefirst member of " struct spi_controller", or the other way around, butit is not the case. "struct spi_controller" is allocated bydevm_spi_alloc_host(), which allocates an extra amount of memory forprivate data, used to store "struct cqspi_st".The ->probe() function of the cadence-quadspi driver then sets thedevice drvdata to store the address of the "struct cqspi_st"structure. Therefore:	struct cqspi_st *cqspi = dev_get_drvdata(dev);is correct, but:	struct spi_controller *host = dev_get_drvdata(dev);is not, as it makes "host" point not to a "struct spi_controller" butto the same "struct cqspi_st" structure as above.This obviously leads to bad things (memory corruption, kernel crashes)directly during ->probe(), as ->probe() enables the device using PMruntime, leading the ->runtime_resume() hook being called, which inturns calls spi_controller_resume() with the wrong pointer.This has at least been reported [0] to cause a kernel crash, but theexact behavior will depend on the memory contents.[0] https://lore.kernel.org/all/20240226121803.5a7r5wkpbbowcxgx@dhruva/This issue potentially affects all platforms that are currently usingthe cadence-quadspi driver.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/fkie-cad/nvd-json-data-feeds
- https://github.com/w4zu/Debian_security

