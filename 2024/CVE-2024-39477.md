### [CVE-2024-39477](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-39477)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=6.9%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=df7a6d1f64056aec572162c5d35ed9ff86ece6f3%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:mm/hugetlb: do not call vma_add_reservation upon ENOMEMsysbot reported a splat [1] on __unmap_hugepage_range().  This is becausevma_needs_reservation() can return -ENOMEM ifallocate_file_region_entries() fails to allocate the file_region structfor the reservation.Check for that and do not call vma_add_reservation() if that is the case,otherwise region_abort() and region_del() will see that we do not have anyfile_regions.If we detect that vma_needs_reservation() returned -ENOMEM, we clear thehugetlb_restore_reserve flag as if this reservation was still consumed, sofree_huge_folio() will not increment the resv count.[1] https://lore.kernel.org/linux-mm/0000000000004096100617c58d54@google.com/T/#ma5983bc1ab18a54910da83416b3f89f3c7ee43aa

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/fkie-cad/nvd-json-data-feeds

