### [CVE-2024-45818](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-45818)
![](https://img.shields.io/static/v1?label=Product&message=Xen&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

The hypervisor contains code to accelerate VGA memory accesses for HVMguests, when the (virtual) VGA is in "standard" mode.  Locking involvedthere has an unusual discipline, leaving a lock acquired past thereturn from the function that acquired it.  This behavior results in aproblem when emulating an instruction with two memory accesses, both ofwhich touch VGA memory (plus some further constraints which aren'trelevant here).  When emulating the 2nd access, the lock that is alreadybeing held would be attempted to be re-acquired, resulting in adeadlock.This deadlock was already found when the code was first introduced, butwas analysed incorrectly and the fix was incomplete.  Analysis in lightof the new finding cannot find a way to make the existing lockingdiscipline work.In staging, this logic has all been removed because it was discoveredto be accidentally disabled since Xen 4.7.  Therefore, we are fixing thelocking problem by backporting the removal of most of the feature.  Notethat even with the feature disabled, the lock would still be acquiredfor any accesses to the VGA MMIO region.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/fkie-cad/nvd-json-data-feeds

