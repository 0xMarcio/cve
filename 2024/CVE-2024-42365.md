### [CVE-2024-42365](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-42365)
![](https://img.shields.io/static/v1?label=Product&message=asterisk&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%2018.24.2%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3C%2018.9-cert11%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%2019.0%2C%20%3C%2020.7-cert2%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%2019.0.0%2C%20%3C%2020.9.2%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%2021.0.0%2C%20%3C%2021.4.2%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=19.0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=19.0.0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=21.0.0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-1220%3A%20Insufficient%20Granularity%20of%20Access%20Control&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-267%3A%20Privilege%20Defined%20With%20Unsafe%20Actions&color=brightgreen)

### Description

Asterisk is an open source private branch exchange (PBX) and telephony toolkit. Prior to asterisk versions 18.24.2, 20.9.2, and 21.4.2 and certified-asterisk versions 18.9-cert11 and 20.7-cert2, an AMI user with `write=originate` may change all configuration files in the `/etc/asterisk/` directory. This occurs because they are able to curl remote files and write them to disk, but are also able to append to existing files using the `FILE` function inside the `SET` application. This issue may result in privilege escalation, remote code execution and/or blind server-side request forgery with arbitrary protocol. Asterisk versions 18.24.2, 20.9.2, and 21.4.2 and certified-asterisk versions 18.9-cert11 and 20.7-cert2 contain a fix for this issue.

### POC

#### Reference
- https://github.com/asterisk/asterisk/security/advisories/GHSA-c4cg-9275-6w44

#### Github
- https://github.com/ARPSyndicate/cve-scores
- https://github.com/fkie-cad/nvd-json-data-feeds

