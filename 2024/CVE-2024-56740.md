### [CVE-2024-56740](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-56740)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=6.12%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=70ba381e1a431245c137ed597ec6a05991c79bd9%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:nfs/localio: must clear res.replen in nfs_local_read_doneOtherwise memory corruption can occur due to NFSv3 LOCALIO readsleaving garbage in res.replen:- nfs3_read_done() copies that into server->read_hdrsize; from there  nfs3_proc_read_setup() copies it to args.replen in new requests.- nfs3_xdr_enc_read3args() passes that to rpc_prepare_reply_pages()  which includes it in hdrsize for xdr_init_pages, so that rq_rcv_buf  contains a ridiculous len.- This is copied to rq_private_buf and xs_read_stream_request()  eventually passes the kvec to sock_recvmsg() which receives incoming  data into entirely the wrong place.This is easily reproduced with NFSv3 LOCALIO that is servicing readswhen it is made to pivot back to using normal RPC.  This switch backto using normal NFSv3 with RPC can occur for a few reasons but thisissue was exposed with a test that stops and then restarts the NFSv3server while LOCALIO is performing heavy read IO.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/cku-heise/euvd-api-doc
- https://github.com/fkie-cad/nvd-json-data-feeds

