### [CVE-2024-23651](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-23651)
![](https://img.shields.io/static/v1?label=Product&message=buildkit&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%200.12.5%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-362%3A%20Concurrent%20Execution%20using%20Shared%20Resource%20with%20Improper%20Synchronization%20('Race%20Condition')&color=brightgreen)

### Description

BuildKit is a toolkit for converting source code to build artifacts in an efficient, expressive and repeatable manner. Two malicious build steps running in parallel sharing the same cache mounts with subpaths could cause a race condition that can lead to files from the host system being accessible to the build container. The issue has been fixed in v0.12.5. Workarounds include, avoiding using BuildKit frontend from an untrusted source or building an untrusted Dockerfile containing cache mounts with --mount=type=cache,source=... options.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/11notes/docker-github-runner
- https://github.com/PuddinCat/GithubRepoSpider
- https://github.com/mightysai1997/leaky-vessels-dynamic-detector
- https://github.com/nclsbayona/leaky-vessels
- https://github.com/plzheheplztrying/cve_monitor
- https://github.com/shkch02/cve_2024_23651
- https://github.com/shkch02/eBPF_cve_2024_23651
- https://github.com/snyk/leaky-vessels-dynamic-detector
- https://github.com/snyk/leaky-vessels-static-detector

