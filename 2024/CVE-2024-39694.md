### [CVE-2024-39694](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-39694)
![](https://img.shields.io/static/v1?label=Product&message=IdentityServer&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3D%20%3C%206.0.5%20&color=brighgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-601%3A%20URL%20Redirection%20to%20Untrusted%20Site%20('Open%20Redirect')&color=brighgreen)

### Description

Duende IdentityServer is an OpenID Connect and OAuth 2.x framework for ASP.NET Core. It is possible for an attacker to craft malicious Urls that certain functions in IdentityServer will incorrectly treat as local and trusted. If such a Url is returned as a redirect, some browsers will follow it to a third-party, untrusted site. Note: by itself, this vulnerability does **not** allow an attacker to obtain user credentials, authorization codes, access tokens, refresh tokens, or identity tokens. An attacker could however exploit this vulnerability as part of a phishing attack designed to steal user credentials. This vulnerability is fixed in 7.0.6, 6.3.10, 6.2.5, 6.1.8, and 6.0.5. Duende.IdentityServer 5.1 and earlier and all versions of IdentityServer4 are no longer supported and will not be receiving updates. If upgrading is not possible, use `IUrlHelper.IsLocalUrl` from ASP.NET Core to validate return Urls in user interface code in the IdentityServer host.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/ArcherTrister/IdentityServer4
- https://github.com/Evolutionary-Networking-Designs/IdentityServer4-Modernization
- https://github.com/IdentityServer/IdentityServer4
- https://github.com/IkerCelorrio/IdentityServer4Fork
- https://github.com/VC-P10/IdentityServer4
- https://github.com/gndev-vn/IdentityServer
- https://github.com/joshuanicol89/IdentityServer4
- https://github.com/skoruba/Duende.IdentityServer.Admin

