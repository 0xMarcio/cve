### [CVE-2024-8013](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-8013)
![](https://img.shields.io/static/v1?label=Product&message=Mongo_crypt_v1.so&color=blue)
![](https://img.shields.io/static/v1?label=Product&message=mongocryptd&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=5.0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=6.0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=7.0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=7.3%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-319%3A%20Cleartext%20Transmission%20of%20Sensitive%20Information&color=brightgreen)

### Description

A bug in query analysis of certain complex self-referential $lookup subpipelines may result in literal values in expressions for encrypted fields to be sent to the server as plaintext instead of ciphertext. Should this occur, no documents would be returned or written. This issue affects mongocryptd binary (v5.0 versions prior to 5.0.29, v6.0 versions prior to 6.0.17, v7.0 versions prior to 7.0.12 and v7.3 versions prior to 7.3.4) and mongo_crypt_v1.so shared libraries (v6.0 versions prior to 6.0.17, v7.0 versions prior to 7.0.12 and v7.3 versions prior to 7.3.4) released alongside MongoDB Enterprise Server versions.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/fkie-cad/nvd-json-data-feeds

