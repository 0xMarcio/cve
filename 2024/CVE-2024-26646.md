### [CVE-2024-26646](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26646)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=1da177e4c3f4%3C%2028f010dc50df%20&color=brighgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=brighgreen)

### Description

In the Linux kernel, the following vulnerability has been resolved:thermal: intel: hfi: Add syscore callbacks for system-wide PMThe kernel allocates a memory buffer and provides its location to thehardware, which uses it to update the HFI table. This allocation occursduring boot and remains constant throughout runtime.When resuming from hibernation, the restore kernel allocates a secondmemory buffer and reprograms the HFI hardware with the new location aspart of a normal boot. The location of the second memory buffer maydiffer from the one allocated by the image kernel.When the restore kernel transfers control to the image kernel, its HFIbuffer becomes invalid, potentially leading to memory corruption if thehardware writes to it (the hardware continues to use the buffer from therestore kernel).It is also possible that the hardware "forgets" the address of the memorybuffer when resuming from "deep" suspend. Memory corruption may also occurin such a scenario.To prevent the described memory corruption, disable HFI when preparing tosuspend or hibernate. Enable it when resuming.Add syscore callbacks to handle the package of the boot CPU (packages ofnon-boot CPUs are handled via CPU offline). Syscore ops always run on theboot CPU. Additionally, HFI only needs to be disabled during "deep" suspendand hibernation. Syscore ops only run in these cases.[ rjw: Comment adjustment, subject and changelog edits ]

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/fkie-cad/nvd-json-data-feeds

