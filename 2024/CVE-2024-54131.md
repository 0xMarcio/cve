### [CVE-2024-54131](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-54131)
![](https://img.shields.io/static/v1?label=Product&message=launcher&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3D%20%3E%3D%201.5.3%2C%20%3C%201.12.3%20&color=brighgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-276%3A%20Incorrect%20Default%20Permissions&color=brighgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-456%3A%20Missing%20Initialization%20of%20a%20Variable&color=brighgreen)

### Description

The Kolide Agent (aka: Launcher) is the lightweight agent designed to work with Kolide's service. An implementation bug in the Kolide Agent (known as `launcher`) allows for local privilege escalation to the SYSTEM user on Windows 10 and 11. The bug was introduced in version 1.5.3 when launcher started storing upgraded binaries in the ProgramData directory. This move to the new directory meant the launcher root directory inherited default permissions that are not as strict as the previous location. These incorrect default permissions in conjunction with an omitted SystemDrive environmental variable (when launcher starts osqueryd), allows a malicious actor with access to the local Windows device to successfully place an arbitrary DLL into the osqueryd process's search path. Under some circumstances, this DLL will be executed when osqueryd performs a WMI query. This combination of events could then allow the attacker to escalate their privileges to SYSTEM. Impacted versions include versions >= 1.5.3 and the fix has been released in 1.12.3.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/Ekitji/siem

