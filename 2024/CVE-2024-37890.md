### [CVE-2024-37890](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-37890)
![](https://img.shields.io/static/v1?label=Product&message=ws&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3D%20%3E%3D%202.1.0%2C%20%3C%205.2.4%20&color=brighgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-476%3A%20NULL%20Pointer%20Dereference&color=brighgreen)

### Description

ws is an open source WebSocket client and server for Node.js. A request with a number of headers exceeding theserver.maxHeadersCount threshold could be used to crash a ws server. The vulnerability was fixed in ws@8.17.1 (e55e510) and backported to ws@7.5.10 (22c2876), ws@6.2.3 (eeb76d3), and ws@5.2.4 (4abd8f6). In vulnerable versions of ws, the issue can be mitigated in the following ways: 1. Reduce the maximum allowed length of the request headers using the --max-http-header-size=size and/or the maxHeaderSize options so that no more headers than the server.maxHeadersCount limit can be sent. 2. Set server.maxHeadersCount to 0 so that no limit is applied.

### POC

#### Reference
- https://github.com/websockets/ws/issues/2230
- https://github.com/websockets/ws/pull/2231
- https://github.com/websockets/ws/security/advisories/GHSA-3h5v-q93c-6h6q

#### Github
- https://github.com/Meersalzeis/pingapp

