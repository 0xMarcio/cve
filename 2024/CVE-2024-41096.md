### [CVE-2024-41096](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-41096)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=5.17%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=bf6e054e0e3fbc9614355b760e18c8a14f952a4e%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:PCI/MSI: Fix UAF in msi_capability_initKFENCE reports the following UAF: BUG: KFENCE: use-after-free read in __pci_enable_msi_range+0x2c0/0x488 Use-after-free read at 0x0000000024629571 (in kfence-#12):  __pci_enable_msi_range+0x2c0/0x488  pci_alloc_irq_vectors_affinity+0xec/0x14c  pci_alloc_irq_vectors+0x18/0x28 kfence-#12: 0x0000000008614900-0x00000000e06c228d, size=104, cache=kmalloc-128 allocated by task 81 on cpu 7 at 10.808142s:  __kmem_cache_alloc_node+0x1f0/0x2bc  kmalloc_trace+0x44/0x138  msi_alloc_desc+0x3c/0x9c  msi_domain_insert_msi_desc+0x30/0x78  msi_setup_msi_desc+0x13c/0x184  __pci_enable_msi_range+0x258/0x488  pci_alloc_irq_vectors_affinity+0xec/0x14c  pci_alloc_irq_vectors+0x18/0x28 freed by task 81 on cpu 7 at 10.811436s:  msi_domain_free_descs+0xd4/0x10c  msi_domain_free_locked.part.0+0xc0/0x1d8  msi_domain_alloc_irqs_all_locked+0xb4/0xbc  pci_msi_setup_msi_irqs+0x30/0x4c  __pci_enable_msi_range+0x2a8/0x488  pci_alloc_irq_vectors_affinity+0xec/0x14c  pci_alloc_irq_vectors+0x18/0x28Descriptor allocation done in:__pci_enable_msi_range    msi_capability_init        msi_setup_msi_desc            msi_insert_msi_desc                msi_domain_insert_msi_desc                    msi_alloc_desc                        ...Freed in case of failure in __msi_domain_alloc_locked()__pci_enable_msi_range    msi_capability_init        pci_msi_setup_msi_irqs            msi_domain_alloc_irqs_all_locked                msi_domain_alloc_locked                    __msi_domain_alloc_locked => fails                    msi_domain_free_locked                        ...That failure propagates back to pci_msi_setup_msi_irqs() inmsi_capability_init() which accesses the descriptor for unmasking in theerror exit path.Cure it by copying the descriptor and using the copy for the error exit pathunmask operation.[ tglx: Massaged change log ]

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/fkie-cad/nvd-json-data-feeds
- https://github.com/robertsirc/sle-bci-demo

