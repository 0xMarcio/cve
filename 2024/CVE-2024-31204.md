### [CVE-2024-31204](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-31204)
![](https://img.shields.io/static/v1?label=Product&message=mailcow-dockerized&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%202024-04%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-79%3A%20Improper%20Neutralization%20of%20Input%20During%20Web%20Page%20Generation%20('Cross-site%20Scripting')&color=brightgreen)

### Description

mailcow: dockerized is an open source groupware/email suite based on docker. A security vulnerability has been identified in mailcow affecting versions prior to 2024-04. This vulnerability resides in the exception handling mechanism, specifically when not operating in DEV_MODE. The system saves exception details into a session array without proper sanitization or encoding. These details are later rendered into HTML and executed in a JavaScript block within the user's browser, without adequate escaping of HTML entities. This flaw allows for Cross-Site Scripting (XSS) attacks, where attackers can inject malicious scripts into the admin panel by triggering exceptions with controlled input. The exploitation method involves using any function that might throw an exception with user-controllable argument. This issue can lead to session hijacking and unauthorized administrative actions, posing a significant security risk. Version 2024-04 contains a fix for the issue.

### POC

#### Reference
- https://www.vicarius.io/vsociety/posts/mailcow-with-xss-and-path-traversal-cve-2024-31204-and-cve-2024-30270

#### Github
- https://github.com/ARPSyndicate/cve-scores
- https://github.com/Tirthikas/XSSplore
- https://github.com/ismailmazumder/SL7CVELabsBuilder
- https://github.com/securelayer7/Research

