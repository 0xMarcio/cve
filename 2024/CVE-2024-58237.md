### [CVE-2024-58237](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-58237)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=5.6%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=51c39bb1d5d105a02e29aa7960f0a395086e6342%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:bpf: consider that tail calls invalidate packet pointersTail-called programs could execute any of the helpers that invalidatepacket pointers. Hence, conservatively assume that each tail callinvalidates packet pointers.Making the change in bpf_helper_changes_pkt_data() automatically makesuse of check_cfg() logic that computes 'changes_pkt_data' effect forglobal sub-programs, such that the following program could berejected:    int tail_call(struct __sk_buff *sk)    {    	bpf_tail_call_static(sk, &jmp_table, 0);    	return 0;    }    SEC("tc")    int not_safe(struct __sk_buff *sk)    {    	int *p = (void *)(long)sk->data;    	... make p valid ...    	tail_call(sk);    	*p = 42; /* this is unsafe */    	...    }The tc_bpf2bpf.c:subprog_tc() needs change: mark it as a function thatcan invalidate packet pointers. Otherwise, it can't be freplaced withtailcall_freplace.c:entry_freplace() that does a tail call.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/oogasawa/Utility-security

