### [CVE-2024-35849](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-35849)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=1da177e4c3f4%3C%20689efe22e9b5%20&color=brighgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=brighgreen)

### Description

In the Linux kernel, the following vulnerability has been resolved:btrfs: fix information leak in btrfs_ioctl_logical_to_ino()Syzbot reported the following information leak for inbtrfs_ioctl_logical_to_ino():  BUG: KMSAN: kernel-infoleak in instrument_copy_to_user include/linux/instrumented.h:114 [inline]  BUG: KMSAN: kernel-infoleak in _copy_to_user+0xbc/0x110 lib/usercopy.c:40   instrument_copy_to_user include/linux/instrumented.h:114 [inline]   _copy_to_user+0xbc/0x110 lib/usercopy.c:40   copy_to_user include/linux/uaccess.h:191 [inline]   btrfs_ioctl_logical_to_ino+0x440/0x750 fs/btrfs/ioctl.c:3499   btrfs_ioctl+0x714/0x1260   vfs_ioctl fs/ioctl.c:51 [inline]   __do_sys_ioctl fs/ioctl.c:904 [inline]   __se_sys_ioctl+0x261/0x450 fs/ioctl.c:890   __x64_sys_ioctl+0x96/0xe0 fs/ioctl.c:890   x64_sys_call+0x1883/0x3b50 arch/x86/include/generated/asm/syscalls_64.h:17   do_syscall_x64 arch/x86/entry/common.c:52 [inline]   do_syscall_64+0xcf/0x1e0 arch/x86/entry/common.c:83   entry_SYSCALL_64_after_hwframe+0x77/0x7f  Uninit was created at:   __kmalloc_large_node+0x231/0x370 mm/slub.c:3921   __do_kmalloc_node mm/slub.c:3954 [inline]   __kmalloc_node+0xb07/0x1060 mm/slub.c:3973   kmalloc_node include/linux/slab.h:648 [inline]   kvmalloc_node+0xc0/0x2d0 mm/util.c:634   kvmalloc include/linux/slab.h:766 [inline]   init_data_container+0x49/0x1e0 fs/btrfs/backref.c:2779   btrfs_ioctl_logical_to_ino+0x17c/0x750 fs/btrfs/ioctl.c:3480   btrfs_ioctl+0x714/0x1260   vfs_ioctl fs/ioctl.c:51 [inline]   __do_sys_ioctl fs/ioctl.c:904 [inline]   __se_sys_ioctl+0x261/0x450 fs/ioctl.c:890   __x64_sys_ioctl+0x96/0xe0 fs/ioctl.c:890   x64_sys_call+0x1883/0x3b50 arch/x86/include/generated/asm/syscalls_64.h:17   do_syscall_x64 arch/x86/entry/common.c:52 [inline]   do_syscall_64+0xcf/0x1e0 arch/x86/entry/common.c:83   entry_SYSCALL_64_after_hwframe+0x77/0x7f  Bytes 40-65535 of 65536 are uninitialized  Memory access of size 65536 starts at ffff888045a40000This happens, because we're copying a 'struct btrfs_data_container' backto user-space. This btrfs_data_container is allocated in'init_data_container()' via kvmalloc(), which does not zero-fill thememory.Fix this by using kvzalloc() which zeroes out the memory on allocation.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/fkie-cad/nvd-json-data-feeds

