### [CVE-2024-53096](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-53096)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=43bed0a13a5cdbb314d14f28c2bf2c60eb4e6e1e%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=6.1%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=66f2ed0172af04a89677ae1898600e1264e25800%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=6757330b1be5b0606125b65ed50caac69bccf9a5%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=a3c08c021778dad30f69895e378843e9f423d734%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=deb0f6562884b5b4beb883d73e66a7d3a1b96d99%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:mm: resolve faulty mmap_region() error path behaviourThe mmap_region() function is somewhat terrifying, with spaghetti-likecontrol flow and numerous means by which issues can arise and incompletestate, memory leaks and other unpleasantness can occur.A large amount of the complexity arises from trying to handle errors latein the process of mapping a VMA, which forms the basis of recentlyobserved issues with resource leaks and observable inconsistent state.Taking advantage of previous patches in this series we move a number ofchecks earlier in the code, simplifying things by moving the core of thelogic into a static internal function __mmap_region().Doing this allows us to perform a number of checks up front before we doany real work, and allows us to unwind the writable unmap checkunconditionally as required and to perform a CONFIG_DEBUG_VM_MAPLE_TREEvalidation unconditionally also.We move a number of things here:1. We preallocate memory for the iterator before we call the file-backed   memory hook, allowing us to exit early and avoid having to perform   complicated and error-prone close/free logic. We carefully free   iterator state on both success and error paths.2. The enclosing mmap_region() function handles the mapping_map_writable()   logic early. Previously the logic had the mapping_map_writable() at the   point of mapping a newly allocated file-backed VMA, and a matching   mapping_unmap_writable() on success and error paths.   We now do this unconditionally if this is a file-backed, shared writable   mapping. If a driver changes the flags to eliminate VM_MAYWRITE, however   doing so does not invalidate the seal check we just performed, and we in   any case always decrement the counter in the wrapper.   We perform a debug assert to ensure a driver does not attempt to do the   opposite.3. We also move arch_validate_flags() up into the mmap_region()   function. This is only relevant on arm64 and sparc64, and the check is   only meaningful for SPARC with ADI enabled. We explicitly add a warning   for this arch if a driver invalidates this check, though the code ought   eventually to be fixed to eliminate the need for this.With all of these measures in place, we no longer need to explicitly closethe VMA on error paths, as we place all checks which might fail prior to acall to any driver mmap hook.This eliminates an entire class of errors, makes the code easier to reasonabout and more robust.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/w4zu/Debian_security

