### [CVE-2024-56717](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-56717)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=06bcb9032e05ad717f9fd0a6e2fd3ae7f430fa31%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=6.11%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=be3a532167dd562ec38900c846e7ae6cc39aa2f1%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=e1b9e80236c540fa85d76e2d510d1b38e1968c5d%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=ff7f554bbd75d5cbf00cded81d05147c6617e876%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:net: mscc: ocelot: fix incorrect IFH SRC_PORT field in ocelot_ifh_set_basic()Packets injected by the CPU should have a SRC_PORT field equal to theCPU port module index in the Analyzer block (ocelot->num_phys_ports).The blamed commit copied the ocelot_ifh_set_basic() call incorrectlyfrom ocelot_xmit_common() in net/dsa/tag_ocelot.c. Instead of callingwith "x", it calls with BIT_ULL(x), but the field is not a port mask,but rather a single port index.[ side note: this is the technical debt of code duplication :( ]The error used to be silent and doesn't appear to have otheruser-visible manifestations, but with new changes in the packinglibrary, it now fails loudly as follows:------------[ cut here ]------------Cannot store 0x40 inside bits 46-43 - will truncatesja1105 spi2.0: xmit timed outWARNING: CPU: 1 PID: 102 at lib/packing.c:98 __pack+0x90/0x198sja1105 spi2.0: timed out polling for tstampCPU: 1 UID: 0 PID: 102 Comm: felix_xmitTainted: G        W        N 6.13.0-rc1-00372-gf706b85d972d-dirty #2605Call trace: __pack+0x90/0x198 (P) __pack+0x90/0x198 (L) packing+0x78/0x98 ocelot_ifh_set_basic+0x260/0x368 ocelot_port_inject_frame+0xa8/0x250 felix_port_deferred_xmit+0x14c/0x258 kthread_worker_fn+0x134/0x350 kthread+0x114/0x138The code path pertains to the ocelot switchdev driver and to the felixsecondary DSA tag protocol, ocelot-8021q. Here seen with ocelot-8021q.The messenger (packing) is not really to blame, so fix the originalcommit instead.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/cku-heise/euvd-api-doc
- https://github.com/fkie-cad/nvd-json-data-feeds
- https://github.com/oogasawa/Utility-security
- https://github.com/w4zu/Debian_security

