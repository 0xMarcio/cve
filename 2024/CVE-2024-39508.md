### [CVE-2024-39508](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-39508)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=1da177e4c3f4%3C%20ab702c3483db%20&color=brighgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=brighgreen)

### Description

In the Linux kernel, the following vulnerability has been resolved:io_uring/io-wq: Use set_bit() and test_bit() at worker->flagsUtilize set_bit() and test_bit() on worker->flags within io_uring/io-wqto address potential data races.The structure io_worker->flags may be accessed through various datapaths, leading to concurrency issues. When KCSAN is enabled, it revealsdata races occurring in io_worker_handle_work andio_wq_activate_free_worker functions.	 BUG: KCSAN: data-race in io_worker_handle_work / io_wq_activate_free_worker	 write to 0xffff8885c4246404 of 4 bytes by task 49071 on cpu 28:	 io_worker_handle_work (io_uring/io-wq.c:434 io_uring/io-wq.c:569)	 io_wq_worker (io_uring/io-wq.c:?)<snip>	 read to 0xffff8885c4246404 of 4 bytes by task 49024 on cpu 5:	 io_wq_activate_free_worker (io_uring/io-wq.c:? io_uring/io-wq.c:285)	 io_wq_enqueue (io_uring/io-wq.c:947)	 io_queue_iowq (io_uring/io_uring.c:524)	 io_req_task_submit (io_uring/io_uring.c:1511)	 io_handle_tw_list (io_uring/io_uring.c:1198)<snip>Line numbers against commit 18daea77cca6 ("Merge tag 'for-linus' ofgit://git.kernel.org/pub/scm/virt/kvm/kvm").These races involve writes and reads to the same memory location bydifferent tasks running on different CPUs. To mitigate this, refactorthe code to use atomic operations such as set_bit(), test_bit(), andclear_bit() instead of basic "and" and "or" operations. This ensuresthread-safe manipulation of worker flags.Also, move `create_index` to avoid holes in the structure.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/bygregonline/devsec-fastapi-report
- https://github.com/robertsirc/sle-bci-demo

