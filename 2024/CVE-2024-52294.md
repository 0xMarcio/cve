### [CVE-2024-52294](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-52294)
![](https://img.shields.io/static/v1?label=Product&message=khoj&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%201.29.0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-639%3A%20Authorization%20Bypass%20Through%20User-Controlled%20Key&color=brightgreen)

### Description

Khoj is a self-hostable artificial intelligence app. Prior to version 1.29.10, an Insecure Direct Object Reference (IDOR) vulnerability in the update_subscription endpoint allows any authenticated user to manipulate other users' Stripe subscriptions by simply modifying the email parameter in the request. The vulnerability exists in the subscription endpoint at `/api/subscription`. The endpoint uses an email parameter as a direct reference to user subscriptions without verifying object ownership. While authentication is required, there is no authorization check to verify if the authenticated user owns the referenced subscription. The issue was fixed in version 1.29.10. Support for arbitrarily presenting an email for update has been deprecated.

### POC

#### Reference
- https://github.com/khoj-ai/khoj/security/advisories/GHSA-hq4h-w933-jm6c

#### Github
No PoCs found on GitHub currently.

