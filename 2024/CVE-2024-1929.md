### [CVE-2024-1929](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-1929)
![](https://img.shields.io/static/v1?label=Product&message=dnf5daemon-server&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3D%205.1.16%3C%3D%20&color=brighgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-20%20Improper%20Input%20Validation&color=brighgreen)

### Description

Local Root Exploit via Configuration Dictionary  in dnf5daemon-server before 5.1.17 allows a malicious user to impact Confidentiality and Integrity via Configuration Dictionary.There are issues with the D-Bus interface long before Polkit is invoked. The `org.rpm.dnf.v0.SessionManager.open_session` method takes a key/value map of configuration entries. A sub-entry in this map, placed under the "config" key, is another key/value map. The configuration values found in it will be forwarded as configuration overrides to the `libdnf5::Base` configuration. Practically all libdnf5 configuration aspects can be influenced here. Already when opening the session via D-Bus, the libdnf5 will be initialized using these override configuration values. There is no sanity checking of the content of this "config" map, which is untrusted data. It is possible to make the library loading a plug-in shared library under control of an unprivileged user, hence achieving root access. 

### POC

#### Reference
- https://www.openwall.com/lists/oss-security/2024/03/04/2

#### Github
- https://github.com/fkie-cad/nvd-json-data-feeds

