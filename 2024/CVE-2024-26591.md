### [CVE-2024-26591](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26591)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=f3a95075549e%3C%20a7b98aa10f89%20&color=brighgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=brighgreen)

### Description

In the Linux kernel, the following vulnerability has been resolved:bpf: Fix re-attachment branch in bpf_tracing_prog_attachThe following case can cause a crash due to missing attach_btf:1) load rawtp program2) load fentry program with rawtp as target_fd3) create tracing link for fentry program with target_fd = 04) repeat 3In the end we have:- prog->aux->dst_trampoline == NULL- tgt_prog == NULL (because we did not provide target_fd to link_create)- prog->aux->attach_btf == NULL (the program was loaded with attach_prog_fd=X)- the program was loaded for tgt_prog but we have no way to find out which one    BUG: kernel NULL pointer dereference, address: 0000000000000058    Call Trace:     <TASK>     ? __die+0x20/0x70     ? page_fault_oops+0x15b/0x430     ? fixup_exception+0x22/0x330     ? exc_page_fault+0x6f/0x170     ? asm_exc_page_fault+0x22/0x30     ? bpf_tracing_prog_attach+0x279/0x560     ? btf_obj_id+0x5/0x10     bpf_tracing_prog_attach+0x439/0x560     __sys_bpf+0x1cf4/0x2de0     __x64_sys_bpf+0x1c/0x30     do_syscall_64+0x41/0xf0     entry_SYSCALL_64_after_hwframe+0x6e/0x76Return -EINVAL in this situation.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/fkie-cad/nvd-json-data-feeds

