### [CVE-2024-47742](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-47742)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=3.7%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=abb139e75c2cdbb955e840d6331cb5863e409d0e%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:firmware_loader: Block path traversalMost firmware names are hardcoded strings, or are constructed from fairlyconstrained format strings where the dynamic parts are just some hexnumbers or such.However, there are a couple codepaths in the kernel where firmware filenames contain string components that are passed through from a device orsemi-privileged userspace; the ones I could find (not counting interfacesthat require root privileges) are: - lpfc_sli4_request_firmware_update() seems to construct the firmware   filename from "ModelName", a string that was previously parsed out of   some descriptor ("Vital Product Data") in lpfc_fill_vpd() - nfp_net_fw_find() seems to construct a firmware filename from a model   name coming from nfp_hwinfo_lookup(pf->hwinfo, "nffw.partno"), which I   think parses some descriptor that was read from the device.   (But this case likely isn't exploitable because the format string looks   like "netronome/nic_%s", and there shouldn't be any *folders* starting   with "netronome/nic_". The previous case was different because there,   the "%s" is *at the start* of the format string.) - module_flash_fw_schedule() is reachable from the   ETHTOOL_MSG_MODULE_FW_FLASH_ACT netlink command, which is marked as   GENL_UNS_ADMIN_PERM (meaning CAP_NET_ADMIN inside a user namespace is   enough to pass the privilege check), and takes a userspace-provided   firmware name.   (But I think to reach this case, you need to have CAP_NET_ADMIN over a   network namespace that a special kind of ethernet device is mapped into,   so I think this is not a viable attack path in practice.)Fix it by rejecting any firmware names containing ".." path components.For what it's worth, I went looking and haven't found any USB devicedrivers that use the firmware loader dangerously.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/w4zu/Debian_security

