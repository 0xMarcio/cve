### [CVE-2024-35852](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-35852)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=c9c9af91f1d9%3C%2051cefc9da400%20&color=brighgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=brighgreen)

### Description

In the Linux kernel, the following vulnerability has been resolved:mlxsw: spectrum_acl_tcam: Fix memory leak when canceling rehash workThe rehash delayed work is rescheduled with a delay if the number ofcredits at end of the work is not negative as supposedly it means thatthe migration ended. Otherwise, it is rescheduled immediately.After "mlxsw: spectrum_acl_tcam: Fix possible use-after-free duringrehash" the above is no longer accurate as a non-negative number ofcredits is no longer indicative of the migration being done. It can alsohappen if the work encountered an error in which case the migration willresume the next time the work is scheduled.The significance of the above is that it is possible for the work to bepending and associated with hints that were allocated when the migrationstarted. This leads to the hints being leaked [1] when the work iscanceled while pending as part of ACL region dismantle.Fix by freeing the hints if hints are associated with a work that wascanceled while pending.Blame the original commit since the reliance on not having a pendingwork associated with hints is fragile.[1]unreferenced object 0xffff88810e7c3000 (size 256):  comm "kworker/0:16", pid 176, jiffies 4295460353  hex dump (first 32 bytes):    00 30 95 11 81 88 ff ff 61 00 00 00 00 00 00 80  .0......a.......    00 00 61 00 40 00 00 00 00 00 00 00 04 00 00 00  ..a.@...........  backtrace (crc 2544ddb9):    [<00000000cf8cfab3>] kmalloc_trace+0x23f/0x2a0    [<000000004d9a1ad9>] objagg_hints_get+0x42/0x390    [<000000000b143cf3>] mlxsw_sp_acl_erp_rehash_hints_get+0xca/0x400    [<0000000059bdb60a>] mlxsw_sp_acl_tcam_vregion_rehash_work+0x868/0x1160    [<00000000e81fd734>] process_one_work+0x59c/0xf20    [<00000000ceee9e81>] worker_thread+0x799/0x12c0    [<00000000bda6fe39>] kthread+0x246/0x300    [<0000000070056d23>] ret_from_fork+0x34/0x70    [<00000000dea2b93e>] ret_from_fork_asm+0x1a/0x30

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/fkie-cad/nvd-json-data-feeds

