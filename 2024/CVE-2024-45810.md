### [CVE-2024-45810](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-45810)
![](https://img.shields.io/static/v1?label=Product&message=envoy&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%201.28.7%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%201.29.0%2C%20%3C%201.29.9%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%201.30.0%2C%20%3C%201.30.6%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%201.31.2%2C%20%3C%201.31.2%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-119%3A%20Improper%20Restriction%20of%20Operations%20within%20the%20Bounds%20of%20a%20Memory%20Buffer&color=brightgreen)

### Description

Envoy is a cloud-native high-performance edge/middle/service proxy. Envoy will crash when the http async client is handling `sendLocalReply` under some circumstance, e.g., websocket upgrade, and requests mirroring. The http async client will crash during the `sendLocalReply()` in http async client, one reason is http async client is duplicating the status code, another one is the destroy of router is called at the destructor of the async stream, while the stream is deferred deleted at first. There will be problems that the stream decoder is destroyed but its reference is called in `router.onDestroy()`, causing segment fault. This will impact ext_authz if the `upgrade` and `connection` header are allowed, and request mirrorring. This issue has been addressed in versions 1.31.2, 1.30.6, 1.29.9, and 1.28.7. Users are advised to upgrade. There are no known workarounds for this vulnerability.

### POC

#### Reference
- https://github.com/envoyproxy/envoy/security/advisories/GHSA-qm74-x36m-555q

#### Github
No PoCs found on GitHub currently.

