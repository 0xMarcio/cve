### [CVE-2024-43835](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-43835)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=5.0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=df133f3f96257ee29696c0ed8bd198ec801dc810%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:virtio_net: Fix napi_skb_cache_put warningAfter the commit bdacf3e34945 ("net: Use nested-BH locking fornapi_alloc_cache.") was merged, the following warning began to appear:	 WARNING: CPU: 5 PID: 1 at net/core/skbuff.c:1451 napi_skb_cache_put+0x82/0x4b0	  __warn+0x12f/0x340	  napi_skb_cache_put+0x82/0x4b0	  napi_skb_cache_put+0x82/0x4b0	  report_bug+0x165/0x370	  handle_bug+0x3d/0x80	  exc_invalid_op+0x1a/0x50	  asm_exc_invalid_op+0x1a/0x20	  __free_old_xmit+0x1c8/0x510	  napi_skb_cache_put+0x82/0x4b0	  __free_old_xmit+0x1c8/0x510	  __free_old_xmit+0x1c8/0x510	  __pfx___free_old_xmit+0x10/0x10The issue arises because virtio is assuming it's running in NAPI contexteven when it's not, such as in the netpoll case.To resolve this, modify virtnet_poll_tx() to only set NAPI when budgetis available. Same for virtnet_poll_cleantx(), which always assumed thatit was in a NAPI context.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/fkie-cad/nvd-json-data-feeds

