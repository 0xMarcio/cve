### [CVE-2024-52289](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-52289)
![](https://img.shields.io/static/v1?label=Product&message=authentik&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%202024.8.5%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%202024.10.0-rc1%2C%20%3C%202024.10.3%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=2024.10.0-rc1%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-185%3A%20Incorrect%20Regular%20Expression&color=brightgreen)

### Description

authentik is an open-source identity provider. Redirect URIs in the OAuth2 provider in authentik are checked by RegEx comparison.When no Redirect URIs are configured in a provider, authentik will automatically use the first redirect_uri value received as an allowed redirect URI, without escaping characters that have a special meaning in RegEx. Similarly, the documentation did not take this into consideration either. Given a provider with the Redirect URIs set to https://foo.example.com, an attacker can register a domain fooaexample.com, and it will correctly pass validation. authentik 2024.8.5 and 2024.10.3 fix this issue. As a workaround, When configuring OAuth2 providers, make sure to escape any wildcard characters that are not intended to function as a wildcard, for example replace `.` with `\.`.

### POC

#### Reference
- https://www.vicarius.io/vsociety/posts/cve-2024-52289-detect-authentik-vulnerability
- https://www.vicarius.io/vsociety/posts/cve-2024-52289-mitigate-authentik-vulnerability

#### Github
No PoCs found on GitHub currently.

