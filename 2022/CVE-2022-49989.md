### [CVE-2022-49989](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-49989)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=4.11%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=ab520be8cd5d56867fc95cfbc34b90880faf1f9d%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:xen/privcmd: fix error exit of privcmd_ioctl_dm_op()The error exit of privcmd_ioctl_dm_op() is calling unlock_pages()potentially with pages being NULL, leading to a NULL dereference.Additionally lock_pages() doesn't check for pin_user_pages_fast()having been completely successful, resulting in potentially notlocking all pages into memory. This could result in sporadic failureswhen using the related memory in user mode.Fix all of that by calling unlock_pages() always with the real numberof pinned pages, which will be zero in case pages being NULL, and bychecking the number of pages pinned by pin_user_pages_fast() matchingthe expected number of pages.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/ARPSyndicate/cve-scores

