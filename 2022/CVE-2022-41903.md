### [CVE-2022-41903](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-41903)
![](https://img.shields.io/static/v1?label=Product&message=git&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%202.30.7%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3D%202.39.0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%202.31.0%2C%20%3C%202.31.6%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%202.32.0%2C%20%3C%202.32.5%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%202.33.0%2C%20%3C%202.33.6%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%202.34.0%2C%20%3C%202.34.6%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%202.35.0%2C%20%3C%202.35.6%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%202.36.0%2C%20%3C%202.36.4%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%202.37.0%2C%20%3C%202.37.5%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%202.38.0%2C%20%3C%202.38.3%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-190%3A%20Integer%20Overflow%20or%20Wraparound&color=brightgreen)

### Description

Git is distributed revision control system. `git log` can display commits in an arbitrary format using its `--format` specifiers. This functionality is also exposed to `git archive` via the `export-subst` gitattribute. When processing the padding operators, there is a integer overflow in `pretty.c::format_and_pad_commit()` where a `size_t` is stored improperly as an `int`, and then added as an offset to a `memcpy()`. This overflow can be triggered directly by a user running a command which invokes the commit formatting machinery (e.g., `git log --format=...`). It may also be triggered indirectly through git archive via the export-subst mechanism, which expands format specifiers inside of files within the repository during a git archive. This integer overflow can result in arbitrary heap writes, which may result in arbitrary code execution. The problem has been patched in the versions published on 2023-01-17, going back to v2.30.7. Users are advised to upgrade. Users who are unable to upgrade should disable `git archive` in untrusted repositories. If you expose git archive via `git daemon`, disable it by running `git config --global daemon.uploadArch false`.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/20142995/nuclei-templates
- https://github.com/9069332997/session-1-full-stack
- https://github.com/ARPSyndicate/cvemon
- https://github.com/BahrainMobilityInternational/BMI-02
- https://github.com/Gandhiprakash07/Trail01
- https://github.com/Jitu-Ranjan/cve-41903
- https://github.com/Reh46/WEB1
- https://github.com/abdulrahmanasdfghj/brubru
- https://github.com/botaktrade/ExnessID.com
- https://github.com/cyb3r-w0lf/nuclei-template-collection
- https://github.com/fkie-cad/nvd-json-data-feeds
- https://github.com/juhp/rpmostree-update
- https://github.com/k0mi-tg/CVE-POC
- https://github.com/karimhabush/cyberowl
- https://github.com/manas3c/CVE-POC
- https://github.com/nomi-sec/PoC-in-GitHub
- https://github.com/sondermc/git-cveissues
- https://github.com/whoforget/CVE-POC
- https://github.com/youwizard/CVE-POC

