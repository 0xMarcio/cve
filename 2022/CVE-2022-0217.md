### [CVE-2022-0217](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0217)
![](https://img.shields.io/static/v1?label=Product&message=prosody&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=Fixed%20in%20prosody%200.11.12%2C%20Affects%20all%20versions%20with%20support%20for%20WebSockets.%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-776%20-%20Improper%20Restriction%20of%20Recursive%20Entity%20References%20in%20DTDs%20('XML%20Entity%20Expansion')%2C%20CWE-20%20-%20Improper%20Input%20Validation.&color=brightgreen)

### Description

It was discovered that an internal Prosody library to load XML based on libexpat does not properly restrict the XML features allowed in parsed XML data. Given suitable attacker input, this results in expansion of recursive entity references from DTDs (CWE-776). In addition, depending on the libexpat version used, it may also allow injections using XML External Entity References (CWE-611).

### POC

#### Reference
- https://prosody.im/security/advisory_20220113/
- https://prosody.im/security/advisory_20220113/1.patch

#### Github
No PoCs found on GitHub currently.

