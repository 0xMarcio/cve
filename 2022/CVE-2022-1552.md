### [CVE-2022-1552](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1552)
![](https://img.shields.io/static/v1?label=Product&message=postgresql&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=Fixed%20in%20postgresql%2014.3%2C%20postgresql%2013.7%2C%20postgresql%2012.11%2C%20postgresql%2011.16%2C%20postgresql%2010.21.%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-459-%20Incomplete%20Cleanup%2C%20CWE-89%20-%20Improper%20Neutralization%20of%20Special%20Elements%20used%20in%20an%20SQL%20Command%20('SQL%20Injection').&color=brightgreen)

### Description

A flaw was found in PostgreSQL. There is an issue with incomplete efforts to operate safely when a privileged user is maintaining another user's objects. The Autovacuum, REINDEX, CREATE INDEX, REFRESH MATERIALIZED VIEW, CLUSTER, and pg_amcheck commands activated relevant protections too late or not at all during the process. This flaw allows an attacker with permission to create non-temporary objects in at least one schema to execute arbitrary SQL functions under a superuser identity.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/ARPSyndicate/cvemon
- https://github.com/brunoh6/postgresql-cve-exploitation
- https://github.com/lekctut/sdb-hw-13-01
- https://github.com/pedr0alencar/vlab-metasploitable2

