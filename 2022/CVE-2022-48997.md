### [CVE-2022-48997](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-48997)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=5.1%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=e891db1a18bf11e02533ec2386b796cfd8d60666%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:char: tpm: Protect tpm_pm_suspend with locksCurrently tpm transactions are executed unconditionally intpm_pm_suspend() function, which may lead to races with other tpmaccessors in the system.Specifically, the hw_random tpm driver makes use of tpm_get_random(),and this function is called in a loop from a kthread, which means it'snot frozen alongside userspace, and so can race with the work doneduring system suspend:  tpm tpm0: tpm_transmit: tpm_recv: error -52  tpm tpm0: invalid TPM_STS.x 0xff, dumping stack for forensics  CPU: 0 PID: 1 Comm: init Not tainted 6.1.0-rc5+ #135  Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.0-20220807_005459-localhost 04/01/2014  Call Trace:   tpm_tis_status.cold+0x19/0x20   tpm_transmit+0x13b/0x390   tpm_transmit_cmd+0x20/0x80   tpm1_pm_suspend+0xa6/0x110   tpm_pm_suspend+0x53/0x80   __pnp_bus_suspend+0x35/0xe0   __device_suspend+0x10f/0x350Fix this by calling tpm_try_get_ops(), which itself is a wrapper aroundtpm_chip_start(), but takes the appropriate mutex.[Jason: reworked commit message, added metadata]

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/ARPSyndicate/cve-scores

