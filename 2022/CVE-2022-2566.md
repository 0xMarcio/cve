### [CVE-2022-2566](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2566)
![](https://img.shields.io/static/v1?label=Product&message=FFMPEG&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=5.1%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=ab77b878f1205225c6de1370fb0e998dbcc8bc69%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=unspecified%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-122%20Heap-based%20Buffer%20Overflow&color=brightgreen)

### Description

A heap out-of-bounds memory write exists in FFMPEG since version 5.1. The size calculation in `build_open_gop_key_points()` goes through all entries in the loop and adds `sc->ctts_data[i].count` to `sc->sample_offsets_count`. This can lead to an integer overflow resulting in a small allocation with `av_calloc()`. An attacker can cause remote code execution via a malicious mp4 file. We recommend upgrading past commit c953baa084607dd1d84c3bfcce3cf6a87c3e6e05

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/akaganeite/CVE4PP
- https://github.com/mark0519/mark0519.github.io

