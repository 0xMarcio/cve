### [CVE-2022-49546](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-49546)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=1da177e4c3f41524e886b7f1b8a0c1fc7321cac2%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:x86/kexec: fix memory leak of elf header bufferThis is reported by kmemleak detector:unreferenced object 0xffffc900002a9000 (size 4096):  comm "kexec", pid 14950, jiffies 4295110793 (age 373.951s)  hex dump (first 32 bytes):    7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00  .ELF............    04 00 3e 00 01 00 00 00 00 00 00 00 00 00 00 00  ..>.............  backtrace:    [<0000000016a8ef9f>] __vmalloc_node_range+0x101/0x170    [<000000002b66b6c0>] __vmalloc_node+0xb4/0x160    [<00000000ad40107d>] crash_prepare_elf64_headers+0x8e/0xcd0    [<0000000019afff23>] crash_load_segments+0x260/0x470    [<0000000019ebe95c>] bzImage64_load+0x814/0xad0    [<0000000093e16b05>] arch_kexec_kernel_image_load+0x1be/0x2a0    [<000000009ef2fc88>] kimage_file_alloc_init+0x2ec/0x5a0    [<0000000038f5a97a>] __do_sys_kexec_file_load+0x28d/0x530    [<0000000087c19992>] do_syscall_64+0x3b/0x90    [<0000000066e063a4>] entry_SYSCALL_64_after_hwframe+0x44/0xaeIn crash_prepare_elf64_headers(), a buffer is allocated via vmalloc() tostore elf headers.  While it's not freed back to system correctly whenkdump kernel is reloaded or unloaded.  Then memory leak is caused.  Fix itby introducing x86 specific function arch_kimage_file_post_load_cleanup(),and freeing the buffer there.And also remove the incorrect elf header buffer freeing code.  Beforecalling arch specific kexec_file loading function, the image instance hasbeen initialized.  So 'image->elf_headers' must be NULL.  It doesn't makesense to free the elf header buffer in the place.Three different people have reported three bugs about the memory leak onx86_64 inside Redhat.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/w4zu/Debian_security

