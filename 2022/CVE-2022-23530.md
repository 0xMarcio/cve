### [CVE-2022-23530](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-23530)
![](https://img.shields.io/static/v1?label=Product&message=guarddog&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3D%20%3C%200.1.8%20&color=brighgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-22%3A%20Improper%20Limitation%20of%20a%20Pathname%20to%20a%20Restricted%20Directory%20('Path%20Traversal')&color=brighgreen)

### Description

GuardDog is a CLI tool to identify malicious PyPI packages. Versions prior to v0.1.8 are vulnerable to arbitrary file write when scanning a specially-crafted remote PyPI package. Extracting files using shutil.unpack_archive() from a potentially malicious tarball without validating that the destination file path is within the intended destination directory can cause files outside the destination directory to be overwritten. This issue is patched in version 0.1.8. Potential workarounds include using a safer module, like zipfile, and validating the location of the extracted files and discarding those with malicious paths.

### POC

#### Reference
- https://github.com/DataDog/guarddog/security/advisories/GHSA-78m5-jpmf-ch7v

#### Github
- https://github.com/ARPSyndicate/cvemon
- https://github.com/Sim4n6/Sim4n6

