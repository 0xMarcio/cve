### [CVE-2022-3918](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3918)
![](https://img.shields.io/static/v1?label=Product&message=Swift%20Foundation&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%3D%205.7.2%20&color=brighgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE%20113%3A%20Improper%20Neutralization%20of%20CRLF%20Sequences%20in%20HTTP%20Headers&color=brighgreen)

### Description

A program using FoundationNetworking in swift-corelibs-foundation is potentially vulnerable to CRLF ( ) injection in URLRequest headers. In this vulnerability, a client can insert one or several CRLF sequences into a URLRequest header value. When that request is sent via URLSession to an HTTP server, the server may interpret the content after the CRLF as extra headers, or even a second request. For example, consider a URLRequest to http://example.com/ with the GET method. Suppose we set the URLRequest header "Foo" to the value "Bar Extra-Header: Added GET /other HTTP/1.1". When this request is sent, it will appear to the server as two requests: GET / HTTP/1.1 Foo: Bar Extra-Header: Added GET /other HTTP/1.1 In this manner, the client is able to inject extra headers and craft an entirely new request to a separate path, despite only making one API call in URLSession. If a developer has total control over the request and its headers, this vulnerability may not pose a threat. However, this vulnerability escalates if un-sanitized user input is placed in header values. If so, a malicious user could inject new headers or requests to an intermediary or backend server. Developers should be especially careful to sanitize user input in this case, or upgrade their version of swift-corelibs-foundation to include the patch below.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/dellalibera/dellalibera

