### [CVE-2023-50260](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-50260)
![](https://img.shields.io/static/v1?label=Product&message=wazuh&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3D%20%3E%3D%204.2.0%2C%20%3C%204.7.2%20&color=brighgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-94%3A%20Improper%20Control%20of%20Generation%20of%20Code%20('Code%20Injection')&color=brighgreen)

### Description

Wazuh is a free and open source platform used for threat prevention, detection, and response. A wrong validation in the `host_deny` script allows to write any string in the `hosts.deny` file, which can end in an arbitrary command execution on the target system. This vulnerability is part of the active response feature, which can automatically triggers actions in response to alerts. By default, active responses are limited to a set of pre defined executables. This is enforced by only allowing executables stored under `/var/ossec/active-response/bin` to be run as an active response. However, the `/var/ossec/active-response/bin/host_deny` can be exploited. `host_deny` is used to add IP address to the `/etc/hosts.deny` file to block incoming connections on a service level by using TCP wrappers. Attacker can inject arbitrary command into the `/etc/hosts.deny` file and execute arbitrary command by using the spawn directive. The active response can be triggered by writing events either to the local `execd` queue on server or to the `ar` queue which forwards the events to agents. So, it can leads to LPE on server as root and RCE on agent as root. This vulnerability is fixed in 4.7.2.

### POC

#### Reference
- https://github.com/wazuh/wazuh/security/advisories/GHSA-mjq2-xf8g-68vw

#### Github
No PoCs found on GitHub currently.

