### [CVE-2023-3128](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3128)
![](https://img.shields.io/static/v1?label=Product&message=Grafana%20Enterprise&color=blue)
![](https://img.shields.io/static/v1?label=Product&message=Grafana&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=6.7.0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=9.2.0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=9.3.0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=9.4.0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=9.5.0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-290&color=brightgreen)

### Description

Grafana is validating Azure AD accounts based on the email claim. On Azure AD, the profile email field is not unique and can be easily modified. This leads to account takeover and authentication bypass when Azure AD OAuth is configured with a multi-tenant app.

### POC

#### Reference
- https://github.com/grafana/bugbounty/security/advisories/GHSA-gxh2-6vvc-rrgp

#### Github
- https://github.com/Threekiii/CVE
- https://github.com/netlas-io/netlas-dorks
- https://github.com/phanfivequ/xinminxuehui-milou-d46T7p3s8FIwKQp0
- https://github.com/plzheheplztrying/cve_monitor
- https://github.com/spyata123/CVE-2023-3128

