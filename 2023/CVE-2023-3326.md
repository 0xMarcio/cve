### [CVE-2023-3326](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3326)
![](https://img.shields.io/static/v1?label=Product&message=FreeBSD&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=12.4-RELEASE%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=13.1-RELEASE%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=13.2-RELEASE%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-303%20%20Incorrect%20Implementation%20of%20Authentication%20Algorithm&color=brightgreen)

### Description

pam_krb5 authenticates a user by essentially running kinit with the password, getting a ticket-granting ticket (tgt) from the Kerberos KDC (Key Distribution Center) over the network, as a way to verify the password. However, if a keytab is not provisioned on the system, pam_krb5 has no way to validate the response from the KDC, and essentially trusts the tgt provided over the network as being valid. In a non-default FreeBSD installation that leverages pam_krb5 for authentication and does not have a keytab provisioned, an attacker that is able to control both the password and the KDC responses can return a valid tgt, allowing authentication to occur for any user on the system.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/Atlas-ghostshell/vulnerability-detection-task3
- https://github.com/robertobuenrostro/Wazuh
- https://github.com/tk-alajmi/SIEM

