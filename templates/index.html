{% extends "base.html" %}
{% set body_class = "color-no-search" %}
{% block content %}
<section class="hero" data-search-root>
  <p class="eyebrow">CVE PoC search &amp; intel</p>
  <h1>Search PoCs, KEV, and EPSS in one place</h1>
  <p class="lede">Pulls PoC references from <code>github.txt</code>, daily CVE descriptions, CISA KEV, and FIRST EPSS so you can quickly find relevant exploits or risk data.</p>
  <div class="pill-row tight">
    <span class="pill"><strong>Search</strong> CVE, vendor, product, or keyword</span>
    <span class="pill">Negative terms supported (<strong>-windows</strong>)</span>
    <span class="pill">Links out to MITRE + PoC repos</span>
    <span class="pill">Nightly GitHub Action refresh</span>
  </div>
  <form class="searchForm" action="#">
    <input type="text" class="search" placeholder="Search CVE, vendor, product, or keyword" autocomplete="off">
  </form>
  <div class="search-meta">
    <span>Loads from <code>CVE_list.json</code></span>
    <span>Updated daily</span>
    <span>Max 10k results for performance</span>
  </div>
  <div class="search-results" data-results style="display:none">
    <div class="header">
      <h2>Results</h2>
      <span class="muted">Fast monospace table for quick scanning</span>
    </div>
    <div class="noResults">No results yet.</div>
    <div class="results-table hide">
      <table class="results">
        <thead>
          <tr>
            <td width="18%">
                CVE
            </td>
            <td>
                Description / PoC links
            </td>
          </tr>
        </thead>
        <tbody class="results"></tbody>
      </table>
    </div>
  </div>
</section>

<section class="section">
  <h1>KEV with high EPSS</h1>
  <p class="muted">KEV items that also carry high EPSS probability.</p>
  <div class="card-grid">
    {% for item in data.kev_top[:15] %}
    <article class="card">
      <div class="card-title"><a href="/cve/{{ item.cve }}.html">{{ item.cve }}</a></div>
      <div class="card-meta">EPSS {{ '%.3f'|format(item.epss or 0) }} • {{ '%2.0f'|format((item.percentile or 0)*100) }}th pct</div>
      <p>{{ item.summary or 'No description.' }}</p>
      <div class="badge">{{ item.vendor or 'Unknown vendor' }}</div>
      <div class="badge">{{ item.product or 'Unknown product' }}</div>
    </article>
    {% endfor %}
  </div>
</section>

<section class="section">
  <h1>EPSS picks not in KEV</h1>
  <p class="muted">High-probability EPSS items that are not yet in the KEV list.</p>
  <div class="card-grid">
    {% for item in data.high_epss[:15] %}
    <article class="card">
      <div class="card-title"><a href="/cve/{{ item.cve }}.html">{{ item.cve }}</a></div>
      <div class="card-meta">EPSS {{ '%.3f'|format(item.epss or 0) }} • {{ '%2.0f'|format((item.percentile or 0)*100) }}th pct</div>
      <p>{{ item.summary or 'No description.' }}</p>
    </article>
    {% endfor %}
  </div>
</section>

<section class="section">
  <h1>Trending PoCs</h1>
  <p class="muted">Fresh GitHub PoCs by stars and recency.</p>
  <div class="table-responsive">
    <table class="list">
      <thead><tr><th>Stars</th><th>Updated</th><th>Name</th><th>Description</th></tr></thead>
      <tbody>
        {% for row in trending[:20] %}
        <tr>
          <td>{{ row.stars }}</td>
          <td>{{ row.updated }}</td>
          <td><a href="{{ row.url }}" target="_blank">{{ row.name }}</a></td>
          <td>{{ row.desc }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</section>

<section class="section">
  <h1>Changes since yesterday</h1>
  <p class="muted">Quick snapshot of the latest diffs in the feeds.</p>
  <div class="table-responsive">
    <table class="list">
      <thead><tr><th>Type</th><th>Count</th><th>Examples</th></tr></thead>
      <tbody>
        <tr>
          <td>New KEV entries</td>
          <td>{{ (diff.new_kev_entries or [])|length }}</td>
          <td>
            {% for row in (diff.new_kev_entries or [])[:5] %}
              <a href="/cve/{{ row.cve }}.html">{{ row.cve }}</a>{% if not loop.last %}, {% endif %}
            {% else %}None{% endfor %}
          </td>
        </tr>
        <tr>
          <td>New high EPSS</td>
          <td>{{ (diff.new_high_epss or [])|length }}</td>
          <td>
            {% for row in (diff.new_high_epss or [])[:5] %}
              <a href="/cve/{{ row.cve }}.html">{{ row.cve }}</a>{% if not loop.last %}, {% endif %}
            {% else %}None{% endfor %}
          </td>
        </tr>
        <tr>
          <td>Top EPSS movers</td>
          <td>{{ (diff.epss_movers or [])|length }}</td>
          <td>
            {% for row in (diff.epss_movers or [])[:5] %}
              <a href="/cve/{{ row.cve }}.html">{{ row.cve }}</a> ({{ '%.3f'|format(row.delta) }}){% if not loop.last %}, {% endif %}
            {% else %}None{% endfor %}
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</section>
{% endblock %}
{% block extra_scripts %}
<script src="/logic.js"></script>
{% endblock %}
