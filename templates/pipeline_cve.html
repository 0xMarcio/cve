{% extends "pipeline_base.html" %}
{% block title %}{{ cve.cve_id }} PoCs{% endblock %}
{% block content %}
  <section>
    <div class="section-header">
      <div>
        <p class="eyebrow">CVE record</p>
        <h1>{{ cve.cve_id }}</h1>
        <p class="muted small">Last updated {{ cve.last_updated }}</p>
      </div>
      <a class="text-link" href="/api/v1/cve/{{ cve.cve_id }}.json">JSON</a>
    </div>

    <div class="card-grid">
      {% for poc in cve.visible_pocs %}
        <article class="card">
          <div class="card-title"><a href="{{ poc.repo_url }}" target="_blank" rel="noreferrer">{{ poc.repo_full_name }}</a></div>
          <div class="meta-row">
            <span class="pill tier-{{ poc.confidence_tier }}">{{ poc.confidence_tier|capitalize }} ({{ poc.confidence_score|round(1) }})</span>
            {% if poc.primary_language %}<span class="pill">{{ poc.primary_language }}</span>{% endif %}
            {% if poc.stars %}<span class="pill">{{ poc.stars }}★</span>{% endif %}
            {% if poc.is_fork %}<span class="pill ghost">Fork</span>{% endif %}
          </div>
          <div class="muted small">
            {% if poc.pushed_at %}Updated {{ poc.pushed_at }} · {% endif %}
            {% if poc.archived %}<span class="pill warn">Archived</span>{% endif %}
            {% if poc.parent_repo_url %}Parent: <a href="{{ poc.parent_repo_url }}" target="_blank" rel="noreferrer">{{ poc.parent_repo_url }}</a>{% endif %}
          </div>
          <div class="pill-row">
            {% for topic in poc.topics %}<span class="pill ghost">{{ topic }}</span>{% endfor %}
          </div>
          <div class="matches">
            <div class="muted small">Matches</div>
            <ul>
              {% for match in poc.matches %}
                <li><span class="pill tiny">{{ match.match_type }}</span> {{ match.path }}</li>
              {% endfor %}
            </ul>
          </div>
        </article>
      {% else %}
        <p class="muted">No PoCs found yet for {{ cve.cve_id }}.</p>
      {% endfor %}
    </div>
  </section>
{% endblock %}
