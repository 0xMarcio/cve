{% extends "pipeline_base.html" %}
{% block title %}CVE PoC Radar{% endblock %}
{% block content %}
  <section class="hero">
    <div>
      <p class="eyebrow">Daily GitHub sweep</p>
      <h1>CVE PoC Goldmine</h1>
      <p class="lede">Incremental discovery, scoring, and diffing for public exploit PoCs. High-confidence hits surface first; low-signal noise stays out of the spotlight.</p>
      <div class="cta-row">
        <a class="btn" href="/pocs/">Open PoC Explorer</a>
        <a class="btn ghost" href="/api/v1/index.json">API index</a>
      </div>
    </div>
    <div class="hero-panel">
      <div class="stat">
        <div class="label">High confidence</div>
        <div class="value">{{ summary.high_total }}</div>
      </div>
      <div class="stat">
        <div class="label">Medium confidence</div>
        <div class="value">{{ summary.medium_total }}</div>
      </div>
      <div class="stat">
        <div class="label">Tracked CVEs</div>
        <div class="value">{{ summary.total_cves }}</div>
      </div>
      <div class="label muted small">Generated {{ summary.generated }}</div>
    </div>
  </section>

  <section>
    <div class="section-header">
      <h2>Top PoCs right now</h2>
      <a class="text-link" href="/api/v1/top/today.json">JSON</a>
    </div>
    <div class="card-grid">
      {% for poc in top %}
        <article class="card">
          <div class="card-title"><a href="{{ poc.repo_url }}" target="_blank" rel="noreferrer">{{ poc.repo_full_name }}</a></div>
          <div class="meta-row">
            <span class="pill tier-{{ poc.tier }}">{{ poc.tier|capitalize }}</span>
            <span class="pill">{{ poc.score|round(1) }} pts</span>
            {% if poc.stars %}<span class="pill">{{ poc.stars }}â˜…</span>{% endif %}
            {% if poc.primary_language %}<span class="pill">{{ poc.primary_language }}</span>{% endif %}
          </div>
          <div class="muted small">CVE: <a href="/cve/{{ poc.cve_id }}.html">{{ poc.cve_id }}</a></div>
        </article>
      {% else %}
        <p class="muted">No PoCs available yet.</p>
      {% endfor %}
    </div>
  </section>

  <section>
    <div class="section-header">
      <h2>Latest diff</h2>
      <a class="text-link" href="/diffs/">Diffs</a>
    </div>
    {% if diff and diff.new_high_conf_pocs %}
      <div class="pill-row">
        {% for item in diff.new_high_conf_pocs %}
          <span class="pill">+ {{ item.cve_id }} / {{ item.repo_full_name }}</span>
        {% endfor %}
      </div>
    {% else %}
      <p class="muted small">No new high-confidence PoCs in the latest run.</p>
    {% endif %}
  </section>
{% endblock %}
