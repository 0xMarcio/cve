### [CVE-2025-37871](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-37871)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=133f5e2a37ce08c82d24e8fba65e0a81deae4609%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=230ca758453c63bd38e4d9f4a21db698f7abada8%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=5.10.236%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=5.15.180%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=6.1.134%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=6.12.23%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=6.14.2%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=6.6.87%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=63b91c8ff4589f5263873b24c052447a28e10ef7%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=9a81cde8c7ce65dd90fb47ceea93a45fc1a2fbd1%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=b874cdef4e67e5150e07eff0eae1cbb21fb92da1%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=cad3479b63661a399c9df1d0b759e1806e2df3c8%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=cdb796137c57e68ca34518d53be53b679351eb86%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=d96587cc93ec369031bcd7658c6adc719873c9fd%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:nfsd: decrease sc_count directly if fail to queue dl_recallA deadlock warning occurred when invoking nfs4_put_stid following a faileddl_recall queue operation:            T1                            T2                                nfs4_laundromat                                 nfs4_get_client_reaplist                                  nfs4_anylock_blockers__break_lease spin_lock // ctx->flc_lock                                   spin_lock // clp->cl_lock                                   nfs4_lockowner_has_blockers                                    locks_owner_has_blockers                                     spin_lock // flctx->flc_lock nfsd_break_deleg_cb  nfsd_break_one_deleg   nfs4_put_stid    refcount_dec_and_lock     spin_lock // clp->cl_lockWhen a file is opened, an nfs4_delegation is allocated with sc_countinitialized to 1, and the file_lease holds a reference to the delegation.The file_lease is then associated with the file through kernel_setlease.The disassociation is performed in nfsd4_delegreturn via the followingcall chain:nfsd4_delegreturn --> destroy_delegation --> destroy_unhashed_deleg -->nfs4_unlock_deleg_lease --> kernel_setlease --> generic_delete_leaseThe corresponding sc_count reference will be released after thisdisassociation.Since nfsd_break_one_deleg executes while holding the flc_lock, thedisassociation process becomes blocked when attempting to acquire flc_lockin generic_delete_lease. This means:1) sc_count in nfsd_break_one_deleg will not be decremented to 0;2) The nfs4_put_stid called by nfsd_break_one_deleg will not attempt toacquire cl_lock;3) Consequently, no deadlock condition is created.Given that sc_count in nfsd_break_one_deleg remains non-zero, we cansafely perform refcount_dec on sc_count directly. This approacheffectively avoids triggering deadlock warnings.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/w4zu/Debian_security

