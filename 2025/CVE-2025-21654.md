### [CVE-2025-21654](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-21654)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=16aac5ad1fa94894b798dd522c5c3a6a0628d7f0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=6.6%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:ovl: support encoding fid from inode with no aliasDmitry Safonov reported that a WARN_ON() assertion can be trigered byuserspace when calling inotify_show_fdinfo() for an overlayfs watchedinode, whose dentry aliases were discarded with drop_caches.The WARN_ON() assertion in inotify_show_fdinfo() was removed, becauseit is possible for encoding file handle to fail for other reason, butthe impact of failing to encode an overlayfs file handle goes beyondthis assertion.As shown in the LTP test case mentioned in the link below, failure toencode an overlayfs file handle from a non-aliased inode also leads tofailure to report an fid with FAN_DELETE_SELF fanotify events.As Dmitry notes in his analyzis of the problem, ovl_encode_fh() failsif it cannot find an alias for the inode, but this failure can be fixed.ovl_encode_fh() seldom uses the alias and in the case of non-decodablefile handles, as is often the case with fanotify fid info,ovl_encode_fh() never needs to use the alias to encode a file handle.Defer finding an alias until it is actually needed so ovl_encode_fh()will not fail in the common case of FAN_DELETE_SELF fanotify events.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/fkie-cad/nvd-json-data-feeds
- https://github.com/oogasawa/Utility-security

