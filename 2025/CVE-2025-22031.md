### [CVE-2025-22031](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-22031)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=6.13%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=665745f274870c921020f610e2c99a3b1613519b%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:PCI/bwctrl: Fix NULL pointer dereference on bus number exhaustionWhen BIOS neglects to assign bus numbers to PCI bridges, the kernelattempts to correct that during PCI device enumeration.  If it runs outof bus numbers, no pci_bus is allocated and the "subordinate" pointer inthe bridge's pci_dev remains NULL.The PCIe bandwidth controller erroneously does not check for a NULLsubordinate pointer and dereferences it on probe.Bandwidth control of unusable devices below the bridge is of questionableutility, so simply error out instead.  This mirrors what PCIe hotplug doessince commit 62e4492c3063 ("PCI: Prevent NULL dereference during pciehpprobe").The PCI core emits a message with KERN_INFO severity if it has run out ofbus numbers.  PCIe hotplug emits an additional message with KERN_ERRseverity to inform the user that hotplug functionality is disabled at thebridge.  A similar message for bandwidth control does not seem merited,given that its only purpose so far is to expose an up-to-date link speedin sysfs and throttle the link speed on certain laptops with limitedThermal Design Power.  So error out silently.User-visible messages:  pci 0000:16:02.0: bridge configuration invalid ([bus 00-00]), reconfiguring  [...]  pci_bus 0000:45: busn_res: [bus 45-74] end is updated to 74  pci 0000:16:02.0: devices behind bridge are unusable because [bus 45-74] cannot be assigned for them  [...]  pcieport 0000:16:02.0: pciehp: Hotplug bridge without secondary bus, ignoring  [...]  BUG: kernel NULL pointer dereference  RIP: pcie_update_link_speed  pcie_bwnotif_enable  pcie_bwnotif_probe  pcie_port_probe_service  really_probe

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/ARPSyndicate/cve-scores

