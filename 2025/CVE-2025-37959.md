### [CVE-2025-37959](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-37959)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=5.10%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=9aa1206e8f48222f35a0c809f33b2f4aaa1e2661%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:bpf: Scrub packet on bpf_redirect_peerWhen bpf_redirect_peer is used to redirect packets to a device inanother network namespace, the skb isn't scrubbed. That can lead skbinformation from one namespace to be "misused" in another namespace.As one example, this is causing Cilium to drop traffic when usingbpf_redirect_peer to redirect packets that just went through IPsecdecryption to a container namespace. The following pwru trace shows (1)the packet path from the host's XFRM layer to the container's XFRMlayer where it's dropped and (2) the number of active skb extensions ateach function.    NETNS       MARK  IFACE  TUPLE                                FUNC    4026533547  d00   eth0   10.244.3.124:35473->10.244.2.158:53  xfrm_rcv_cb                             .active_extensions = (__u8)2,    4026533547  d00   eth0   10.244.3.124:35473->10.244.2.158:53  xfrm4_rcv_cb                             .active_extensions = (__u8)2,    4026533547  d00   eth0   10.244.3.124:35473->10.244.2.158:53  gro_cells_receive                             .active_extensions = (__u8)2,    [...]    4026533547  0     eth0   10.244.3.124:35473->10.244.2.158:53  skb_do_redirect                             .active_extensions = (__u8)2,    4026534999  0     eth0   10.244.3.124:35473->10.244.2.158:53  ip_rcv                             .active_extensions = (__u8)2,    4026534999  0     eth0   10.244.3.124:35473->10.244.2.158:53  ip_rcv_core                             .active_extensions = (__u8)2,    [...]    4026534999  0     eth0   10.244.3.124:35473->10.244.2.158:53  udp_queue_rcv_one_skb                             .active_extensions = (__u8)2,    4026534999  0     eth0   10.244.3.124:35473->10.244.2.158:53  __xfrm_policy_check                             .active_extensions = (__u8)2,    4026534999  0     eth0   10.244.3.124:35473->10.244.2.158:53  __xfrm_decode_session                             .active_extensions = (__u8)2,    4026534999  0     eth0   10.244.3.124:35473->10.244.2.158:53  security_xfrm_decode_session                             .active_extensions = (__u8)2,    4026534999  0     eth0   10.244.3.124:35473->10.244.2.158:53  kfree_skb_reason(SKB_DROP_REASON_XFRM_POLICY)                             .active_extensions = (__u8)2,In this case, there are no XFRM policies in the container's networknamespace so the drop is unexpected. When we decrypt the IPsec packet,the XFRM state used for decryption is set in the skb extensions. Thisinformation is preserved across the netns switch. When we reach theXFRM policy check in the container's netns, __xfrm_policy_check dropsthe packet with LINUX_MIB_XFRMINNOPOLS because a (container-side) XFRMpolicy can't be found that matches the (host-side) XFRM state used fordecryption.This patch fixes this by scrubbing the packet when usingbpf_redirect_peer, as is done on typical netns switches via vethdevices except skb->mark and skb->tstamp are not zeroed.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/runwhen-contrib/helm-charts
- https://github.com/w4zu/Debian_security

