### [CVE-2025-24359](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-24359)
![](https://img.shields.io/static/v1?label=Product&message=asteval&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%201.0.6%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-134%3A%20Use%20of%20Externally-Controlled%20Format%20String&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-749%3A%20Exposed%20Dangerous%20Method%20or%20Function&color=brightgreen)

### Description

ASTEVAL is an evaluator of Python expressions and statements. Prior to version 1.0.6, if an attacker can control the input to the `asteval` library, they can bypass asteval's restrictions and execute arbitrary Python code in the context of the application using the library. The vulnerability is rooted in how `asteval` performs handling of `FormattedValue` AST nodes. In particular, the `on_formattedvalue` value uses the dangerous format method of the str class. The code allows an attacker to manipulate the value of the string used in the dangerous call `fmt.format(__fstring__=val)`. This vulnerability can be exploited to access protected attributes by intentionally triggering an `AttributeError` exception. The attacker can then catch the exception and use its `obj` attribute to gain arbitrary access to sensitive or protected object properties. Version 1.0.6 fixes this issue.

### POC

#### Reference
- https://github.com/lmfit/asteval/security/advisories/GHSA-3wwr-3g9f-9gc7

#### Github
No PoCs found on GitHub currently.

