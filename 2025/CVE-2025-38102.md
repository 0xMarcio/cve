### [CVE-2025-38102](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-38102)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=4.0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=a1d88436d53a75e950db15834b3d2f8c0c358fdc%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:VMCI: fix race between vmci_host_setup_notify and vmci_ctx_unset_notifyDuring our test, it is found that a warning can be trigger in try_grab_folioas follow:  ------------[ cut here ]------------  WARNING: CPU: 0 PID: 1678 at mm/gup.c:147 try_grab_folio+0x106/0x130  Modules linked in:  CPU: 0 UID: 0 PID: 1678 Comm: syz.3.31 Not tainted 6.15.0-rc5 #163 PREEMPT(undef)  RIP: 0010:try_grab_folio+0x106/0x130  Call Trace:   <TASK>   follow_huge_pmd+0x240/0x8e0   follow_pmd_mask.constprop.0.isra.0+0x40b/0x5c0   follow_pud_mask.constprop.0.isra.0+0x14a/0x170   follow_page_mask+0x1c2/0x1f0   __get_user_pages+0x176/0x950   __gup_longterm_locked+0x15b/0x1060   ? gup_fast+0x120/0x1f0   gup_fast_fallback+0x17e/0x230   get_user_pages_fast+0x5f/0x80   vmci_host_unlocked_ioctl+0x21c/0xf80  RIP: 0033:0x54d2cd  ---[ end trace 0000000000000000 ]---Digging into the source, context->notify_page may init by get_user_pages_fastand can be seen in vmci_ctx_unset_notify which will try to put_page. Howeverget_user_pages_fast is not finished here and lead to followingtry_grab_folio warning. The race condition is shown as follow:cpu0			cpu1vmci_host_do_set_notifyvmci_host_setup_notifyget_user_pages_fast(uva, 1, FOLL_WRITE, &context->notify_page);lockless_pages_from_mmgup_pgd_rangegup_huge_pmd  // update &context->notify_page			vmci_host_do_set_notify			vmci_ctx_unset_notify			notify_page = context->notify_page;			if (notify_page)			put_page(notify_page);	// page is freed__gup_longterm_locked__get_user_pagesfollow_trans_huge_pmdtry_grab_folio // warn hereTo slove this, use local variable page to make notify_page can be seenafter finish get_user_pages_fast.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/w4zu/Debian_security

