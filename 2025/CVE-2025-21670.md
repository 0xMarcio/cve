### [CVE-2025-21670](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-21670)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=6.4%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=634f1a7110b439c65fd8a809171c1d2d28bcea6f%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:vsock/bpf: return early if transport is not assignedSome of the core functions can only be called if the transporthas been assigned.As Michal reported, a socket might have the transport at NULL,for example after a failed connect(), causing the following trace:    BUG: kernel NULL pointer dereference, address: 00000000000000a0    #PF: supervisor read access in kernel mode    #PF: error_code(0x0000) - not-present page    PGD 12faf8067 P4D 12faf8067 PUD 113670067 PMD 0    Oops: Oops: 0000 [#1] PREEMPT SMP NOPTI    CPU: 15 UID: 0 PID: 1198 Comm: a.out Not tainted 6.13.0-rc2+    RIP: 0010:vsock_connectible_has_data+0x1f/0x40    Call Trace:     vsock_bpf_recvmsg+0xca/0x5e0     sock_recvmsg+0xb9/0xc0     __sys_recvfrom+0xb3/0x130     __x64_sys_recvfrom+0x20/0x30     do_syscall_64+0x93/0x180     entry_SYSCALL_64_after_hwframe+0x76/0x7eSo we need to check the `vsk->transport` in vsock_bpf_recvmsg(),especially for connected sockets (stream/seqpacket) as we alreadydo in __vsock_connectible_recvmsg().

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/fkie-cad/nvd-json-data-feeds
- https://github.com/xairy/linux-kernel-exploitation

