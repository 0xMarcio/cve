### [CVE-2025-5054](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-5054)
![](https://img.shields.io/static/v1?label=Product&message=Apport&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=2.20%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=2.20.1%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=2.20.11%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=2.20.9%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=2.28.1%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=2.30.0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=2.32.0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-362%20Concurrent%20Execution%20using%20Shared%20Resource%20with%20Improper%20Synchronization%20('Race%20Condition')&color=brightgreen)

### Description

Race condition in Canonical apport up to and including 2.32.0 allows a local attacker to leak sensitive information via PID-reuse by leveraging namespaces.When handling a crash, the function `_check_global_pid_and_forward`, which detects if the crashing process resided in a container, was being called before `consistency_checks`, which attempts to detect if the crashing process had been replaced. Because of this, if a process crashed and was quickly replaced with a containerized one, apport could be made to forward the core dump to the container, potentially leaking sensitive information. `consistency_checks` is now being called before `_check_global_pid_and_forward`. Additionally, given that the PID-reuse race condition cannot be reliably detected from userspace alone, crashes are only forwarded to containers if the kernel provided a pidfd, or if the crashing process was unprivileged (i.e., if dump mode == 1).

### POC

#### Reference
- https://www.qualys.com/2025/05/29/apport-coredump/apport-coredump.txt

#### Github
- https://github.com/ARPSyndicate/cve-scores
- https://github.com/PuddinCat/GithubRepoSpider
- https://github.com/daryllundy/cve-2025-5054
- https://github.com/nomi-sec/PoC-in-GitHub
- https://github.com/pawan-shivarkar/List-of-CVE-s-
- https://github.com/pawan-shivarkar/pawan-shivarkar

