### [CVE-2025-46340](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-46340)
![](https://img.shields.io/static/v1?label=Product&message=misskey&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%2012.0.0%2C%20%3C%202025.4.1%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-116%3A%20Improper%20Encoding%20or%20Escaping%20of%20Output&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-20%3A%20Improper%20Input%20Validation&color=brightgreen)

### Description

Misskey is an open source, federated social media platform. Starting in version 12.0.0 and prior to version 2025.4.1, due to an oversight in the validation performed in `UrlPreviewService` and `MkUrlPreview`, it is possible for an attacker to inject arbitrary CSS into the `MkUrlPreview` component. `UrlPreviewService.wrap` falls back to returning the original URL if it's using a protocol that is likely to not be understood by Misskey, IE something other than `http` or `https`. This both can de-anonymize users and_allow further attacks in the client. Additionally, `MkUrlPreview` doesn't escape CSS when applying a `background-image` property, allowing an attacker to craft a URL that applies arbitrary styles to the preview element. Theoretically, an attacker can craft a CSS injection payload to create a fake error message that can deceive the user into giving away their credentials or similar sensitive information. Version 2025.4.1 contains a patch for the issue.

### POC

#### Reference
- https://github.com/misskey-dev/misskey/security/advisories/GHSA-3p2w-xmv5-jm95

#### Github
- https://github.com/fkie-cad/nvd-json-data-feeds

