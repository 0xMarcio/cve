### [CVE-2025-31498](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-31498)
![](https://img.shields.io/static/v1?label=Product&message=c-ares&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%201.32.3%2C%20%3C%201.34.5%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-416%3A%20Use%20After%20Free&color=brightgreen)

### Description

c-ares is an asynchronous resolver library. From 1.32.3 through 1.34.4, there is a use-after-free in read_answers() when process_answer() may re-enqueue a query either due to a DNS Cookie Failure or when the upstream server does not properly support EDNS, or possibly on TCP queries if the remote closed the connection immediately after a response. If there was an issue trying to put that new transaction on the wire, it would close the connection handle, but read_answers() was still expecting the connection handle to be available to possibly dequeue other responses. In theory a remote attacker might be able to trigger this by flooding the target with ICMP UNREACHABLE packets if they also control the upstream nameserver and can return a result with one of those conditions, this has been untested. Otherwise only a local attacker might be able to change system behavior to make send()/write() return a failure condition. This vulnerability is fixed in 1.34.5.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/ReneDiff/TrivyExternImageTest
- https://github.com/flavio/sbom-merger
- https://github.com/kaisensan/desafio-girus-pick
- https://github.com/piyushpcs/Vulnerability-Scan-with-Nessus

