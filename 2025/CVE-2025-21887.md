### [CVE-2025-21887](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-21887)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=1ecdc55e5cd9f70f8d7513802971d4cffb9f77af%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=33ab4dd6202f359558a0a2678b94d1b9994c17e5%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=6.5%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=62f29ca45f832e281fc14966ac25f6ff3bd121ca%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=714ba10a6dd19752a349e59aa875f3288ccb59b9%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=b07d5cc93e1b28df47a72c519d09d0a836043613%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=e4f2a1feebb3f209a0fca82aa53507a5b8be4d53%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:ovl: fix UAF in ovl_dentry_update_reval by moving dput() in ovl_link_upThe issue was caused by dput(upper) being called beforeovl_dentry_update_reval(), while upper->d_flags was stillaccessed in ovl_dentry_remote().Move dput(upper) after its last use to prevent use-after-free.BUG: KASAN: slab-use-after-free in ovl_dentry_remote fs/overlayfs/util.c:162 [inline]BUG: KASAN: slab-use-after-free in ovl_dentry_update_reval+0xd2/0xf0 fs/overlayfs/util.c:167Call Trace: <TASK> __dump_stack lib/dump_stack.c:88 [inline] dump_stack_lvl+0x116/0x1f0 lib/dump_stack.c:114 print_address_description mm/kasan/report.c:377 [inline] print_report+0xc3/0x620 mm/kasan/report.c:488 kasan_report+0xd9/0x110 mm/kasan/report.c:601 ovl_dentry_remote fs/overlayfs/util.c:162 [inline] ovl_dentry_update_reval+0xd2/0xf0 fs/overlayfs/util.c:167 ovl_link_up fs/overlayfs/copy_up.c:610 [inline] ovl_copy_up_one+0x2105/0x3490 fs/overlayfs/copy_up.c:1170 ovl_copy_up_flags+0x18d/0x200 fs/overlayfs/copy_up.c:1223 ovl_rename+0x39e/0x18c0 fs/overlayfs/dir.c:1136 vfs_rename+0xf84/0x20a0 fs/namei.c:4893... </TASK>

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/ARPSyndicate/cve-scores
- https://github.com/w4zu/Debian_security

