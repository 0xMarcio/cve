### [CVE-2021-29624](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29624)
![](https://img.shields.io/static/v1?label=Product&message=fastify-csrf&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%203.1.0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-565%3A%20Reliance%20on%20Cookies%20without%20Validation%20and%20Integrity%20Checking&color=brightgreen)

### Description

fastify-csrf is an open-source plugin helps developers protect their Fastify server against CSRF attacks. Versions of fastify-csrf prior to 3.1.0 have a "double submit" mechanism using cookies with an application deployed across multiple subdomains, e.g. "heroku"-style platform as a service. Version 3.1.0 of the fastify-csrf fixes it. the vulnerability. The user of the module would need to supply a `userInfo` when generating the CSRF token to fully implement the protection on their end. This is needed only for applications hosted on different subdomains.

### POC

#### Reference
- https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html

#### Github
- https://github.com/ARPSyndicate/cvemon

