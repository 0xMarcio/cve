### [CVE-2021-39174](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-39174)
![](https://img.shields.io/static/v1?label=Product&message=Cachet&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=n%2Fa&color=blue)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-75%3A%20Failure%20to%20Sanitize%20Special%20Elements%20into%20a%20Different%20Plane%20(Special%20Element%20Injection)&color=brighgreen)

### Description

Cachet is an open source status page system. Prior to version 2.5.1, authenticated users, regardless of their privileges (User or Admin), can leak the value of any configuration entry of the dotenv file, e.g. the application secret (`APP_KEY`) and various passwords (email, database, etc). This issue was addressed in version 2.5.1 by improving `UpdateConfigCommandHandler` and preventing the use of nested variables in the resulting dotenv configuration file. As a workaround, only allow trusted source IP addresses to access to the administration dashboard.

### POC

#### Reference
- https://blog.sonarsource.com/cachet-code-execution-via-laravel-configuration-injection/

#### Github
- https://github.com/ARPSyndicate/cvemon
- https://github.com/NaInSec/CVE-PoC-in-GitHub
- https://github.com/SYRTI/POC_to_review
- https://github.com/WhooAmii/POC_to_review
- https://github.com/hadrian3689/cachet_2.4.0-dev
- https://github.com/n0kovo/CVE-2021-39174-PoC
- https://github.com/n0kovo/n0kovo
- https://github.com/nomi-sec/PoC-in-GitHub
- https://github.com/trhacknon/Pocingit
- https://github.com/zecool/cve

