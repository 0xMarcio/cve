### [CVE-2021-22112](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-22112)
![](https://img.shields.io/static/v1?label=Product&message=Spring%20Security&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=5.4.x%20%20prior%20to%205.4.4%2C%205.3.x%20prior%20to%205.3.8.RELEASE%2C%205.2.x%20prior%20to%205.2.9.RELEASE%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=Privilege%20Escalation%20by%20changing%20security%20context&color=brightgreen)

### Description

Spring Security 5.4.x prior to 5.4.4, 5.3.x prior to 5.3.8.RELEASE, 5.2.x prior to 5.2.9.RELEASE, and older unsupported versions can fail to save the SecurityContext if it is changed more than once in a single request.A malicious user cannot cause the bug to happen (it must be programmed in). However, if the application's intent is to only allow the user to run with elevated privileges in a small portion of the application, the bug can be leveraged to extend those privileges to the rest of the application.

### POC

#### Reference
- https://www.oracle.com//security-alerts/cpujul2021.html
- https://www.oracle.com/security-alerts/cpuApr2021.html
- https://www.oracle.com/security-alerts/cpuoct2021.html

#### Github
- https://github.com/Dzmitry-Basiachenka/dist-foreign-aliakh
- https://github.com/auth0/auth0-spring-security-api
- https://github.com/junxiant/xnat-aws-monailabel
- https://github.com/n0-traces/cve_monitor

