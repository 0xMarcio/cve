### [CVE-2021-44731](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44731)
![](https://img.shields.io/static/v1?label=Product&message=snapd&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%3D%202.54.2%20&color=brighgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-362%20Race%20Condition%20(Concurrent%20Execution%20using%20Shared%20Resource%20with%20Improper%20Synchronization)&color=brighgreen)

### Description

A race condition existed in the snapd 2.54.2 snap-confine binary when preparing a private mount namespace for a snap. This could allow a local attacker to gain root privileges by bind-mounting their own contents inside the snap's private mount namespace and causing snap-confine to execute arbitrary code and hence gain privilege escalation. Fixed in snapd versions 2.54.3+18.04, 2.54.3+20.04 and 2.54.3+21.10.1

### POC

#### Reference
- http://packetstormsecurity.com/files/170176/snap-confine-must_mkdir_and_open_with_perms-Race-Condition.html
- http://www.openwall.com/lists/oss-security/2022/02/23/1

#### Github
- https://github.com/ARPSyndicate/cvemon
- https://github.com/bollwarm/SecToolSet
- https://github.com/deeexcee-io/CVE-2021-44731-snap-confine-SUID
- https://github.com/teresaweber685/book_list

