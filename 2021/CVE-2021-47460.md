### [CVE-2021-47460](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47460)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=36ed9e604215f58cec0381ca5fcc6da05f2d87ca%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=5.10%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=6dbf7bb555981fb5faf7b691e8f6169fc2b2e63b%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=7ce2b16bad2cbfa3fa7bbc42c4448914f639ca47%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=7ed80e77c908cbaa686529a49f8ae0060c5caee7%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=acef5107e2eacb08a16ad5db60320d65bd26a6c0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=f8a6a2ed4b7d1c3c8631eeb6d00572bc853094a8%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:ocfs2: fix data corruption after conversion from inline formatCommit 6dbf7bb55598 ("fs: Don't invalidate page buffers inblock_write_full_page()") uncovered a latent bug in ocfs2 conversionfrom inline inode format to a normal inode format.The code in ocfs2_convert_inline_data_to_extents() attempts to zero outthe whole cluster allocated for file data by grabbing, zeroing, anddirtying all pages covering this cluster.  However these pages arebeyond i_size, thus writeback code generally ignores these dirty pagesand no blocks were ever actually zeroed on the disk.This oversight was fixed by commit 693c241a5f6a ("ocfs2: No need to zeropages past i_size.") for standard ocfs2 write path, inline conversionpath was apparently forgotten; the commit log also has a reasoning whythe zeroing actually is not needed.After commit 6dbf7bb55598, things became worse as writeback code stoppedinvalidating buffers on pages beyond i_size and thus these pages end upwith clean PageDirty bit but with buffers attached to these pages beingstill dirty.  So when a file is converted from inline format, thenwriteback triggers, and then the file is grown so that these pagesbecome valid, the invalid dirtiness state is preserved,mark_buffer_dirty() does nothing on these pages (buffers are alreadydirty) but page is never written back because it is clean.  So datawritten to these pages is lost once pages are reclaimed.Simple reproducer for the problem is:  xfs_io -f -c "pwrite 0 2000" -c "pwrite 2000 2000" -c "fsync" \    -c "pwrite 4000 2000" ocfs2_fileAfter unmounting and mounting the fs again, you can observe that end of'ocfs2_file' has lost its contents.Fix the problem by not doing the pointless zeroing during conversionfrom inline format similarly as in the standard write path.[akpm@linux-foundation.org: fix whitespace, per Joseph]

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/fkie-cad/nvd-json-data-feeds

